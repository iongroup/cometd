<!DOCTYPE html>
<html lang="en">

<head>
  <title>CometD Oort Auction Demo</title>
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Varela+Round">
  <link rel="stylesheet" type="text/css" href="auction.css"/>
  <script type="module" src="auction.js"></script>
  <script type="text/javascript">
      const config = {
          contextPath: location.href.replace(/https?:\/\/[^\/]*/, "").replace(/\/auction2\/.*$/, "")
      };
  </script>
</head>

<body>

<a style="text-decoration: none" href="/">
  <img style="width: 3em" src="../cometd_logo.png" alt="CometD Logo"/>
  <span style="font-size: 3em; border:0; margin-bottom: 3em">CometD</span>
</a>

<!-- The welcome page displayed before login. Hidden after login. -->
<div id="welcome">
  <h1>Auction Demo</h1>
  <p>This auction application is a demonstration of
    some of the features of <a href="https://cometd.org/">CometD Oort</a>.
    The site uses CometD to dynamically distribute auction bids and chat about items.
    CometD Oort is used to distribute these events in the cluster.
    You must set the <code>oort.cloud</code> init parameter of
    the Oort Servlet in <code>web.xml</code> so that other nodes are discovered.
  </p>
  <p>
    To use this demo:
  </p>
  <ul>
    <li>Log in using any username.</li>
    <li>When bids are made against items, these are published on CometD channels.</li>
    <li>Chat about items with other bidders is also distributed with CometD channels.</li>
    <li>If a chat message is prefixed with <code>name::</code> then the message is sent
      privately to that user using the Oort Seti service to find the user in the cluster.
    </li>
    <li>If you connect to the auction from multiple windows/tabs from the same
      browser, then one of them will work in polling mode and have greater latency.
      For best effect, user two browsers.
    </li>
  </ul>
  <div id="login">
    <label for="login-name">Acme Auctions</label>
    <input id="login-name" type="text"/>
    <button id="login-button">Login</button>
  </div>
</div>

<!-- The auction page displayed after login. Hidden after logout. -->
<div id="auction">
  <div id="banner">
    <div id="banner-title">Acme Auctions</div>
    <div id="banner-user">Welcome: <span id="user"></span></div>
  </div>
  <div id="catalog">
    <div id="catalog-categories">
      <h2>Categories</h2>
      <label for="search-text"></label>
      <input id="search-text" type="text"/>
      <button id="search-button">Search</button>
      <div id="categories"></div>
    </div>
    <div id="items"></div>
  </div>
  <div id="my-bids">
    <h2>My Bids - <span id="dateTime"></span></h2>
    <table>
      <thead>
      <tr>
        <th>Item</th>
        <th>Current Bid</th>
        <th>Bidder</th>
        <th colspan="3">Actions</th>
      </tr>
      </thead>
      <tbody id="bids">
      </tbody>
    </table>
  </div>
  <!-- The chat panel is shown when the bidder wants to chat about an item. -->
  <div id="chat">
    <div id="chat-banner"></div>
    <div id="chat-room">
      <div id="chat-messages"></div>
      <div id="chat-item"></div>
      <div id="chat-members"></div>
    </div>
    <div id="chat-control">
      <label for="chat-text">Message:</label>
      <input id="chat-text" type="text"/>
      <button id="chat-send">Send</button>
      <button id="chat-leave">Leave</button>
    </div>
  </div>
</div>
</body>

</html>
